<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shankara Prakashana Samithi - Receipt Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            background: #1F6B4D;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            color: #FFFFFF;
        }

        @media (max-width: 768px) {
            body {
                padding: 16px;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 12px;
            }
        }

        .app-header {
            text-align: center;
            margin-bottom: 30px;
            width: 100%;
            max-width: 1000px;
        }

        @media (max-width: 768px) {
            .app-header {
                margin-bottom: 24px;
            }

            .app-title {
                font-size: 24px;
            }

            .app-subtitle {
                font-size: 12px;
            }
        }

        @media (max-width: 480px) {
            .app-header {
                margin-bottom: 20px;
            }

            .app-title {
                font-size: 20px;
            }
        }

        .app-title {
            font-size: 32px;
            font-weight: 700;
            color: #FFFFFF;
            margin-bottom: 5px;
            letter-spacing: 0.5px;
        }

        .app-subtitle {
            font-size: 14px;
            color: #E0E0E0;
            font-weight: 400;
        }

        .container {
            max-width: 1000px;
            width: 100%;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            align-items: start;
        }

        @media (max-width: 960px) {
            .container {
                grid-template-columns: 1fr;
                gap: 30px;
            }
        }

        .form-section {
            background: #2D5A4C;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            border: 2px solid #4A8A73;
        }

        @media (max-width: 768px) {
            .form-section {
                padding: 24px;
                border-radius: 16px;
            }
        }

        @media (max-width: 480px) {
            .form-section {
                padding: 16px;
            }
        }

        .form-section h1 {
            color: #FFFFFF;
            margin-bottom: 30px;
            font-size: 22px;
            text-align: center;
            font-weight: 600;
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            color: #FFFFFF;
            font-weight: 600;
            font-size: 16px;
            letter-spacing: 0.3px;
        }

        .date-picker-container {
            margin-bottom: 24px;
        }

        .date-picker-label {
            display: block;
            margin-bottom: 12px;
            color: #FFFFFF;
            font-weight: 600;
            font-size: 16px;
            letter-spacing: 0.3px;
        }

        .date-pills {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding: 8px 0;
            margin-bottom: 12px;
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
        }

        @media (max-width: 768px) {
            .date-pills {
                gap: 8px;
            }
        }

        .date-pills::-webkit-scrollbar {
            height: 3px;
        }

        .date-pills::-webkit-scrollbar-track {
            background: transparent;
            border-radius: 10px;
        }

        .date-pills::-webkit-scrollbar-thumb {
            background: #D4C4B0;
            border-radius: 10px;
        }

        .date-pill {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-width: 65px;
            padding: 16px 12px;
            border: none;
            border-radius: 14px;
            background: transparent;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 11px;
            color: #8B7D7D;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .date-pill {
                min-width: 55px;
                padding: 12px 10px;
                border-radius: 12px;
                font-size: 10px;
            }
        }

        @media (max-width: 480px) {
            .date-pill {
                min-width: 50px;
                padding: 10px 8px;
                border-radius: 10px;
            }
        }

        .date-pill:hover {
            background: #3D6B5C;
            color: #FFFFFF;
        }

        .date-pill.active {
            background: #7AB99A;
            color: white;
            box-shadow: 0 6px 16px rgba(122, 185, 154, 0.35);
        }

        .date-pill.active .date-pill-day {
            color: rgba(255, 255, 255, 0.95);
        }

        .date-pill.active .date-pill-date {
            color: white;
        }

        .date-pill-day {
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.6px;
            margin-bottom: 6px;
            color: #B0B0B0;
        }

        .date-pill-date {
            font-size: 18px;
            font-weight: 700;
            color: #FFFFFF;
        }

        @media (max-width: 768px) {
            .date-pill-date {
                font-size: 16px;
            }
        }

        @media (max-width: 480px) {
            .date-pill-date {
                font-size: 14px;
            }
        }

        .form-group input[type="text"],
        .form-group textarea {
            width: 100%;
            padding: 14px;
            border: 2px solid #4A8A73;
            border-radius: 12px;
            font-family: inherit;
            font-size: 14px;
            color: #2D2D2D;
            background: #FFFFFF;
            transition: all 0.3s;
        }

        @media (max-width: 768px) {
            .form-group input[type="text"],
            .form-group textarea {
                padding: 12px;
                font-size: 13px;
                border-radius: 10px;
            }
        }

        @media (max-width: 480px) {
            .form-group input[type="text"],
            .form-group textarea {
                padding: 10px;
                font-size: 12px;
            }
        }

        .form-group input[type="text"]::placeholder,
        .form-group textarea::placeholder {
            color: #B8A89D;
        }

        .form-group input[type="text"]:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #F4A261;
            background: #FFFBF6;
            box-shadow: 0 0 0 4px rgba(244, 162, 97, 0.15);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 90px;
        }

        .items-section {
            margin-top: 32px;
            padding-top: 24px;
            border-top: 2px solid #E8DFCE;
        }

        .items-section h2 {
            color: #FFFFFF;
            margin-bottom: 18px;
            font-size: 18px;
            font-weight: 600;
            letter-spacing: 0.3px;
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            padding: 16px;
            background: #3D6B5C;
            border: 2px solid #5A9A7F;
            border-radius: 12px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        @media (max-width: 768px) {
            .checkbox-group {
                padding: 14px;
                border-radius: 10px;
                margin-bottom: 10px;
            }
        }

        @media (max-width: 480px) {
            .checkbox-group {
                padding: 12px;
                flex-wrap: wrap;
            }
        }

        .checkbox-group:hover {
            border-color: #7AB99A;
            background: #4A7B6C;
        }

        .checkbox-group input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            margin-bottom: 12px;
            accent-color: #7AB99A;
            border-radius: 4px;
        }

        .item-label {
            color: #FFFFFF;
            font-weight: 600;
            font-size: 18px;
            margin-bottom: 12px;
        }

        .item-controls {
            display: flex;
            align-items: center;
            gap: 12px;
            width: 100%;
        }

        .item-price {
            color: #FFFFFF;
            font-weight: 700;
            font-size: 18px;
        }

        @media (max-width: 768px) {
            .item-label {
                font-size: 17px;
            }

            .item-price {
                font-size: 17px;
            }
        }

        @media (max-width: 480px) {
            .item-label {
                font-size: 16px;
            }

            .item-price {
                font-size: 16px;
            }
        }

        @media (max-width: 360px) {
            .item-label {
                font-size: 15px;
            }

            .item-price {
                font-size: 15px;
            }
        }

        .quantity-select {
            margin-left: 12px;
            margin-right: 12px;
            padding: 8px 12px;
            border: 2px solid #E8DFCE;
            border-radius: 8px;
            background: white;
            color: #2D2D2D;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
        }

        @media (max-width: 768px) {
            .quantity-select {
                margin-left: 8px;
                margin-right: 8px;
                padding: 6px 10px;
                font-size: 12px;
                border-radius: 6px;
            }
        }

        @media (max-width: 480px) {
            .quantity-select {
                margin-left: 6px;
                margin-right: 6px;
                padding: 5px 8px;
                font-size: 11px;
            }
        }

        .quantity-select:hover {
            border-color: #7AB99A;
        }

        .quantity-select:focus {
            outline: none;
            border-color: #7AB99A;
            box-shadow: 0 0 0 3px rgba(122, 185, 154, 0.15);
        }

        .donation-input {
            padding: 8px 12px;
            border: 2px solid #5A9A7F;
            border-radius: 8px;
            font-family: inherit;
            font-size: 14px;
            color: #2D2D2D;
            background: #FFFFFF;
            transition: all 0.3s;
        }

        .donation-input::placeholder {
            color: #999999;
        }

        .donation-input:focus {
            outline: none;
            border-color: #7AB99A;
            background: #FFFFFF;
            box-shadow: 0 0 0 3px rgba(122, 185, 154, 0.15);
        }

        @media (max-width: 768px) {
            .donation-input {
                width: 100px !important;
                padding: 6px 10px;
                font-size: 12px;
                border-radius: 6px;
            }
        }

        @media (max-width: 480px) {
            .donation-input {
                width: 80px !important;
                padding: 5px 8px;
                font-size: 11px;
            }
        }

        .button-group {
            display: flex;
            gap: 14px;
            margin-top: 32px;
        }

        @media (max-width: 768px) {
            .button-group {
                gap: 12px;
                margin-top: 24px;
            }
        }

        @media (max-width: 480px) {
            .button-group {
                flex-direction: column;
                gap: 10px;
            }
        }

        button {
            flex: 1;
            padding: 16px;
            border: none;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            letter-spacing: 0.3px;
        }

        @media (max-width: 480px) {
            button {
                padding: 14px;
                font-size: 14px;
            }
        }

        .btn-generate {
            background: #7AB99A;
            color: white;
            box-shadow: 0 4px 15px rgba(122, 185, 154, 0.3);
        }

        .btn-generate:hover {
            background: #5A9A7F;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(122, 185, 154, 0.4);
        }

        .btn-reset {
            background: #FFFFFF;
            color: #1F6B4D;
            border: 2px solid #7AB99A;
        }

        .btn-reset:hover {
            background: #E8F5F1;
            transform: translateY(-2px);
        }

        .receipt-section {
            background: #2D5A4C;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            border: 2px solid #4A8A73;
            position: sticky;
            top: 20px;
        }

        @media (max-width: 960px) {
            .receipt-section {
                position: relative;
                top: 0;
            }
        }

        @media (max-width: 768px) {
            .receipt-section {
                padding: 24px;
                border-radius: 16px;
            }
        }

        @media (max-width: 480px) {
            .receipt-section {
                padding: 16px;
            }
        }

        .receipt-content {
            display: none;
            text-align: center;
            background: white;
            padding: 32px;
            border-radius: 16px;
            border: 2px solid #7AB99A;
            box-shadow: 0 8px 24px rgba(122, 185, 154, 0.15);
        }

        @media (max-width: 768px) {
            .receipt-content {
                padding: 24px;
                border-radius: 12px;
            }
        }

        @media (max-width: 480px) {
            .receipt-content {
                padding: 16px;
            }
        }

        .receipt-content.visible {
            display: block;
        }

        .receipt-header {
            margin-bottom: 28px;
            padding-bottom: 20px;
            border-bottom: 3px solid #7AB99A;
        }

        .receipt-title {
            color: #7AB99A;
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
            letter-spacing: 0.5px;
        }

        .receipt-subtitle {
            color: #8B7D7D;
            font-size: 13px;
            font-weight: 600;
            letter-spacing: 0.3px;
        }

        @media (max-width: 768px) {
            .receipt-title {
                font-size: 24px;
            }

            .receipt-subtitle {
                font-size: 12px;
            }
        }

        @media (max-width: 480px) {
            .receipt-title {
                font-size: 20px;
            }

            .receipt-subtitle {
                font-size: 11px;
            }
        }

        .receipt-details {
            text-align: left;
            margin-bottom: 28px;
            background: #F5F5F5;
            padding: 18px;
            border-radius: 12px;
            border: 1px solid #E8DFCE;
        }

        .receipt-field {
            text-align: left;
            margin-bottom: 14px;
            display: flex;
            justify-content: space-between;
            align-items: baseline;
        }

        .receipt-field:last-child {
            margin-bottom: 0;
        }

        .receipt-field-label {
            color: #8B7D7D;
            font-size: 11px;
            text-transform: uppercase;
            font-weight: 700;
            letter-spacing: 0.5px;
            flex: 0 0 auto;
            margin-right: 12px;
        }

        .receipt-field-value {
            color: #2D2D2D;
            font-size: 14px;
            font-weight: 600;
            text-align: right;
            flex: 1;
        }

        .receipt-items {
            margin: 28px 0;
            padding: 20px 0;
            border-top: 2px solid #7AB99A;
            border-bottom: 2px solid #7AB99A;
        }

        .receipt-items-header {
            display: grid;
            grid-template-columns: 2fr 0.8fr 1fr;
            gap: 12px;
            padding-bottom: 12px;
            margin-bottom: 16px;
            border-bottom: 2px solid #E8DFCE;
            font-weight: 700;
            font-size: 11px;
            text-transform: uppercase;
            color: #8B7D7D;
            letter-spacing: 0.4px;
        }

        .receipt-item {
            display: grid;
            grid-template-columns: 2fr 0.8fr 1fr;
            gap: 12px;
            align-items: center;
            padding: 14px 0;
            border-bottom: 1px solid #4A8A73;
            font-size: 13px;
        }

        .receipt-item:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .receipt-item-name {
            color: #2D2D2D;
            font-weight: 600;
            text-align: left;
        }

        .receipt-item-meta {
            font-size: 11px;
            color: #8B7D7D;
            margin-top: 4px;
            text-align: left;
        }

        .receipt-item-qty {
            color: #2D2D2D;
            font-weight: 600;
            text-align: center;
        }

        .receipt-item-price {
            color: #7AB99A;
            font-weight: 700;
            text-align: right;
        }

        .receipt-total {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-top: 24px;
            padding-top: 20px;
            padding-bottom: 20px;
            background: #F5F5F5;
            border-radius: 12px;
            padding: 20px;
            border: 2px solid #7AB99A;
        }

        .total-label {
            color: #2D2D2D;
            font-size: 18px;
            font-weight: 700;
            text-align: left;
        }

        .total-amount {
            color: #7AB99A;
            font-size: 24px;
            font-weight: 700;
            text-align: right;
        }

        .receipt-actions {
            display: flex;
            gap: 12px;
            margin-top: 28px;
        }

        .btn-share,
        .btn-print {
            flex: 1;
            padding: 16px 20px;
            border: 2px solid #7AB99A;
            background: #FFFFFF;
            color: #1F6B4D;
            border-radius: 12px;
            font-weight: 700;
            font-size: 15px;
            cursor: pointer;
            transition: all 0.3s;
            display: block !important;
            visibility: visible !important;
        }

        .btn-share:hover,
        .btn-print:hover {
            background: #7AB99A;
            color: #FFFFFF;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(122, 185, 154, 0.3);
        }

        .empty-receipt {
            text-align: center;
            color: #B0B0B0;
            padding: 50px 20px;
            font-size: 14px;
            line-height: 1.6;
        }

        .date-range {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 20px;
        }

        .date-range p {
            font-size: 12px;
            color: #B0B0B0;
        }

        @media (max-width: 1024px) {
            .container {
                gap: 30px;
            }

            .form-section,
            .receipt-section {
                padding: 32px;
            }
        }

        @media (max-width: 900px) {
            .container {
                grid-template-columns: 1fr;
                gap: 24px;
            }

            .receipt-section {
                position: static;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 16px;
            }

            .app-header {
                margin-bottom: 24px;
            }

            .app-title {
                font-size: 26px;
                margin-bottom: 4px;
            }

            .app-subtitle {
                font-size: 12px;
            }

            .container {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .form-section {
                padding: 28px;
                border-radius: 16px;
            }

            .form-section h1 {
                font-size: 20px;
                margin-bottom: 24px;
            }

            .receipt-section {
                position: static;
                padding: 28px;
                border-radius: 16px;
                margin-top: 20px;
            }

            .form-group {
                margin-bottom: 20px;
            }

            .form-group label {
                font-size: 15px;
                margin-bottom: 8px;
            }

            .form-group input[type="text"],
            .form-group textarea {
                padding: 12px;
                font-size: 16px;
                border-radius: 10px;
            }

            .form-group textarea {
                min-height: 80px;
            }

            .checkbox-group {
                padding: 14px;
                margin-bottom: 10px;
                flex-wrap: wrap;
            }

            .item-label {
                font-size: 13px;
            }

            .item-price {
                font-size: 14px;
            }

            .quantity-select {
                margin-left: 10px;
                margin-right: 10px;
                padding: 6px 10px;
                font-size: 12px;
            }

            .button-group {
                flex-direction: column;
                gap: 10px;
                margin-top: 24px;
            }

            button {
                padding: 14px;
                font-size: 14px;
            }

            .date-pill {
                min-width: 58px;
                padding: 12px 10px;
                font-size: 10px;
            }

            .date-pill-date {
                font-size: 16px;
            }

            .date-pills {
                margin-bottom: 10px;
            }

            .items-section {
                margin-top: 24px;
                padding-top: 20px;
            }

            .items-section h2 {
                font-size: 15px;
                margin-bottom: 16px;
            }

            .receipt-content {
                padding: 0;
            }

            .receipt-header {
                margin-bottom: 20px;
                padding-bottom: 14px;
            }

            .receipt-title {
                font-size: 20px;
            }

            .receipt-field {
                margin-bottom: 14px;
                padding-bottom: 10px;
            }

            .receipt-field-label {
                font-size: 10px;
            }

            .receipt-field-value {
                font-size: 14px;
            }

            .receipt-items {
                margin: 18px 0;
                padding: 14px 0;
            }

            .receipt-item {
                display: grid;
                grid-template-columns: 2fr 0.8fr 1fr;
                gap: 12px;
                margin-bottom: 10px;
                font-size: 13px;
                align-items: center;
                padding: 10px 0;
                border-bottom: 1px solid #E8DFCE;
            }

            .receipt-item-name {
                font-size: 12px;
                font-weight: 600;
            }

            .receipt-item-meta {
                font-size: 10px;
            }

            .receipt-item-qty {
                text-align: center;
                font-size: 12px;
            }

            .receipt-item-price {
                text-align: right;
                font-size: 12px;
                font-weight: 600;
            }

            .total-label {
                font-size: 14px;
            }

            .total-amount {
                font-size: 20px;
            }

            .receipt-actions {
                flex-direction: column;
                gap: 10px;
                margin-top: 20px;
            }

            .btn-share,
            .btn-print {
                padding: 12px;
                font-size: 13px;
            }

            .modal-content {
                padding: 28px;
                max-width: 340px;
                margin: 20px;
                border-radius: 16px;
            }

            .modal-content h2 {
                font-size: 18px;
                margin-bottom: 14px;
            }

            .modal-content p {
                font-size: 13px;
                margin-bottom: 20px;
            }

            .modal-buttons button {
                padding: 12px;
                font-size: 13px;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 14px;
                min-height: 100vh;
            }

            .app-header {
                margin-bottom: 16px;
            }

            .app-title {
                font-size: 22px;
                font-weight: 700;
            }

            .app-subtitle {
                font-size: 11px;
            }

            .form-section,
            .receipt-section {
                padding: 20px;
                border-radius: 14px;
            }

            .form-section h1 {
                font-size: 18px;
                margin-bottom: 18px;
            }

            .form-group {
                margin-bottom: 16px;
            }

            .form-group label {
                font-size: 14px;
                margin-bottom: 6px;
            }

            .form-group input[type="text"],
            .form-group textarea {
                padding: 10px;
                font-size: 14px;
                border-radius: 8px;
                border: 2px solid #E8DFCE;
            }

            .form-group textarea {
                min-height: 70px;
                resize: vertical;
            }

            .checkbox-group {
                padding: 12px;
                margin-bottom: 8px;
                flex-wrap: wrap;
            }

            .checkbox-group input[type="checkbox"] {
                width: 18px;
                height: 18px;
                margin-right: 10px;
            }

            .item-label {
                font-size: 12px;
                flex-grow: 1;
            }

            .item-price {
                font-size: 13px;
                white-space: nowrap;
                margin-left: 8px;
            }

            .quantity-select {
                margin-left: 8px;
                margin-right: 0;
                padding: 6px 8px;
                font-size: 11px;
            }

            .button-group {
                flex-direction: column;
                gap: 8px;
                margin-top: 18px;
            }

            button {
                width: 100%;
                padding: 12px;
                font-size: 13px;
                border-radius: 10px;
            }

            .date-pills {
                gap: 6px;
                margin-bottom: 8px;
                padding: 6px 0;
            }

            .date-pill {
                min-width: 50px;
                padding: 10px 8px;
                border-radius: 10px;
            }

            .date-pill-day {
                font-size: 9px;
                margin-bottom: 4px;
            }

            .date-pill-date {
                font-size: 14px;
            }

            .date-picker-container {
                margin-bottom: 18px;
            }

            .date-picker-label {
                font-size: 14px;
                margin-bottom: 8px;
            }

            .items-section {
                margin-top: 18px;
                padding-top: 16px;
                border-top: 2px solid #E8DFCE;
            }

            .items-section h2 {
                font-size: 16px;
                margin-bottom: 12px;
            }

            .receipt-title {
                font-size: 18px;
                margin-bottom: 4px;
            }

            .receipt-subtitle {
                font-size: 11px;
            }

            .receipt-header {
                margin-bottom: 16px;
                padding-bottom: 12px;
                border-bottom: 2px solid #F4A261;
            }

            .receipt-field {
                margin-bottom: 12px;
                padding-bottom: 8px;
                border-bottom: 1px solid #E8DFCE;
            }

            .receipt-field-label {
                font-size: 9px;
                margin-bottom: 4px;
            }

            .receipt-field-value {
                font-size: 13px;
                font-weight: 500;
            }

            .receipt-items {
                margin: 16px 0;
                padding: 12px 0;
                border-top: 1px solid #E8DFCE;
                border-bottom: 1px solid #E8DFCE;
            }

            .receipt-item {
                display: grid;
                grid-template-columns: 1.5fr 0.7fr 1fr;
                gap: 8px;
                margin-bottom: 8px;
                font-size: 11px;
                align-items: center;
                padding: 8px 0;
                border-bottom: 1px solid #E8DFCE;
            }

            .receipt-item-name {
                font-size: 11px;
                font-weight: 600;
            }

            .receipt-item-meta {
                font-size: 9px;
            }

            .receipt-item-qty {
                text-align: center;
                font-size: 11px;
            }

            .receipt-item-price {
                text-align: right;
                font-size: 11px;
                font-weight: 600;
            }

            .receipt-total {
                margin-top: 12px;
                padding-top: 8px;
            }

            .total-label {
                font-size: 13px;
            }

            .total-amount {
                font-size: 18px;
            }

            .receipt-actions {
                flex-direction: column;
                gap: 8px;
                margin-top: 16px;
            }

            .btn-share,
            .btn-print {
                width: 100%;
                padding: 10px;
                font-size: 12px;
                border-radius: 10px;
            }

            .empty-receipt {
                padding: 30px 16px;
                font-size: 13px;
            }

            .modal {
                padding: 16px;
            }

            .modal-content {
                padding: 20px;
                max-width: 280px;
                margin: 16px;
                border-radius: 14px;
            }

            .modal-content h2 {
                font-size: 16px;
                margin-bottom: 12px;
            }

            .modal-content p {
                font-size: 12px;
                margin-bottom: 16px;
                line-height: 1.5;
            }

            .modal-buttons {
                gap: 8px;
            }

            .modal-buttons button {
                padding: 10px;
                font-size: 12px;
                border-radius: 8px;
            }
        }

        @media (max-width: 360px) {
            .app-title {
                font-size: 20px;
            }

            .form-section,
            .receipt-section {
                padding: 16px;
            }

            .form-group input[type="text"],
            .form-group textarea {
                padding: 8px;
                font-size: 14px;
            }

            .date-pill {
                min-width: 45px;
                padding: 8px 6px;
            }

            .quantity-select {
                padding: 4px 6px;
                font-size: 10px;
            }
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }

            .app-header,
            .form-section {
                display: none;
            }

            .receipt-actions {
                display: none !important;
            }

            .container {
                grid-template-columns: 1fr;
                gap: 0;
            }

            .receipt-section {
                box-shadow: none;
                padding: 0;
                border: none;
                background: white;
            }
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.4);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: #2D5A4C;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 420px;
            border: 2px solid #4A8A73;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        .modal-content h2 {
            color: #7AB99A;
            margin-bottom: 16px;
            font-size: 20px;
            font-weight: 700;
        }

        .modal-content p {
            color: #FFFFFF;
            margin-bottom: 24px;
            line-height: 1.6;
            font-size: 14px;
        }

        .modal-buttons {
            display: flex;
            gap: 12px;
        }

        .modal-buttons button {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
        }

        .btn-cancel {
            background: #FFFFFF;
            color: #1F6B4D;
            border: 2px solid #7AB99A;
        }

        .btn-cancel:hover {
            background: #E8F5F1;
        }

        .btn-confirm {
            background: #7AB99A;
            color: white;
        }

        .btn-confirm:hover {
            background: #5A9A7F;
        }
    </style>
</head>
<body>
    <div class="app-header">
        <h1 class="app-title">Shankara Prakashana Samithi</h1>
        <p class="app-subtitle">Receipt Generator</p>
    </div>

    <div class="container">
        <!-- Form Section -->
        <div class="form-section">
            <h1>Create Receipt</h1>

            <!-- Date Picker -->
            <div class="date-picker-container">
                <label class="date-picker-label">Select Date</label>
                <div class="date-pills" id="datePills"></div>
                <input type="date" id="customDate" style="display: none; width: 100%; padding: 14px; border: 2px solid #E8DFCE; border-radius: 12px; font-size: 14px; margin-top: 8px;">
            </div>

            <!-- Donor Details -->
            <div class="form-group">
                <label>Donor Name</label>
                <input type="text" id="donorName" placeholder="Enter donor name">
            </div>

            <div class="form-group">
                <label>Phone Number</label>
                <input type="text" id="phone" placeholder="Enter phone number">
            </div>

            <div class="form-group">
                <label>Address</label>
                <textarea id="address" placeholder="Enter address"></textarea>
            </div>

            <!-- Items Section -->
            <div class="items-section">
                <h2>Select Books</h2>
                
                <label class="checkbox-group">
                    <input type="checkbox" value="Saraswati Pramukha Poshakaru" data-price="100000" data-basePrice="100000" class="item-checkbox">
                    <span class="item-label">Saraswati Pramukha Poshakaru</span>
                    <div class="item-controls">
                        <select class="quantity-select" data-base-price="100000">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                        </select>
                        <span class="item-price">₹100000</span>
                    </div>
                </label>

                <label class="checkbox-group">
                    <input type="checkbox" value="Bhamini Maha Poshakaru" data-price="50000" data-basePrice="50000" class="item-checkbox">
                    <span class="item-label">Bhamini Maha Poshakaru</span>
                    <div class="item-controls">
                        <select class="quantity-select" data-base-price="50000">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                        </select>
                        <span class="item-price">₹50000</span>
                    </div>
                </label>

                <label class="checkbox-group">
                    <input type="checkbox" value="Girvani Jgnana Poshakaru" data-price="25000" data-basePrice="25000" class="item-checkbox">
                    <span class="item-label">Girvani Jgnana Poshakaru</span>
                    <div class="item-controls">
                        <select class="quantity-select" data-base-price="25000">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                        </select>
                        <span class="item-price">₹25000</span>
                    </div>
                </label>

                <label class="checkbox-group">
                    <input type="checkbox" value="Veenapaani Poshakaru" data-price="10000" data-basePrice="10000" class="item-checkbox">
                    <span class="item-label">Veenapaani Poshakaru</span>
                    <div class="item-controls">
                        <select class="quantity-select" data-base-price="10000">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                        </select>
                        <span class="item-price">₹10000</span>
                    </div>
                </label>

                <label class="checkbox-group">
                    <input type="checkbox" value="Complete Set" data-price="6000" data-basePrice="6000" class="item-checkbox">
                    <span class="item-label">Complete Set</span>
                    <div class="item-controls">
                        <select class="quantity-select" data-base-price="6000">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                        </select>
                        <span class="item-price">₹6000</span>
                    </div>
                </label>

                <label class="checkbox-group">
                    <input type="checkbox" value="Full Set A (Ramayana)" data-price="4000" data-basePrice="4000" class="item-checkbox">
                    <span class="item-label">Full Set A (Ramayana)</span>
                    <div class="item-controls">
                        <select class="quantity-select" data-base-price="4000">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                        </select>
                        <span class="item-price">₹4000</span>
                    </div>
                </label>

                <label class="checkbox-group">
                    <input type="checkbox" value="Full Set B (All Other 5)" data-price="4000" data-basePrice="4000" class="item-checkbox">
                    <span class="item-label">Full Set B (All Other 5)</span>
                    <div class="item-controls">
                        <select class="quantity-select" data-base-price="4000">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                        </select>
                        <span class="item-price">₹4000</span>
                    </div>
                </label>

                <label class="checkbox-group">
                    <input type="checkbox" value="Ramayana" data-price="4000" data-basePrice="4000" class="item-checkbox">
                    <span class="item-label">Ramayana</span>
                    <div class="item-controls">
                        <select class="quantity-select" data-base-price="4000">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                        </select>
                        <span class="item-price">₹4000</span>
                    </div>
                </label>

                <label class="checkbox-group">
                    <input type="checkbox" value="Brahmantaranga" data-price="1000" data-basePrice="1000" class="item-checkbox">
                    <span class="item-label">Brahmantaranga</span>
                    <div class="item-controls">
                        <select class="quantity-select" data-base-price="1000">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                        </select>
                        <span class="item-price">₹1000</span>
                    </div>
                </label>

                <label class="checkbox-group">
                    <input type="checkbox" value="Geetantaranga" data-price="1000" data-basePrice="1000" class="item-checkbox">
                    <span class="item-label">Geetantaranga</span>
                    <div class="item-controls">
                        <select class="quantity-select" data-base-price="1000">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                        </select>
                        <span class="item-price">₹1000</span>
                    </div>
                </label>

                <label class="checkbox-group">
                    <input type="checkbox" value="Sankshipta Ramayana" data-price="400" data-basePrice="400" class="item-checkbox">
                    <span class="item-label">Sankshipta Ramayana</span>
                    <div class="item-controls">
                        <select class="quantity-select" data-base-price="400">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                        </select>
                        <span class="item-price">₹400</span>
                    </div>
                </label>

                <label class="checkbox-group">
                    <input type="checkbox" value="Kathopanishath" data-price="400" data-basePrice="400" class="item-checkbox">
                    <span class="item-label">Kathopanishath</span>
                    <div class="item-controls">
                        <select class="quantity-select" data-base-price="400">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                        </select>
                        <span class="item-price">₹400</span>
                    </div>
                </label>

                <label class="checkbox-group">
                    <input type="checkbox" value="Saundarya Lahari" data-price="400" data-basePrice="400" class="item-checkbox">
                    <span class="item-label">Saundarya Lahari</span>
                    <div class="item-controls">
                        <select class="quantity-select" data-base-price="400">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                        </select>
                        <span class="item-price">₹400</span>
                    </div>
                </label>

                <label class="checkbox-group">
                    <input type="checkbox" value="Donation" data-price="0" data-basePrice="0" class="item-checkbox" id="donation-checkbox">
                    <span class="item-label">Donation</span>
                    <div class="item-controls">
                        <input type="number" id="donation-amount" placeholder="Enter amount" class="donation-input" min="0" step="1">
                        <span class="item-price">₹<span id="donation-display">0</span></span>
                    </div>
                </label>
            </div>

            <!-- Action Buttons -->
            <div class="button-group">
                <button class="btn-generate" onclick="generateReceipt()">Generate Receipt</button>
                <button class="btn-reset" onclick="resetForm()">Reset</button>
            </div>
        </div>

        <!-- Receipt Section -->
        <div class="receipt-section">
            <div id="receipt" class="receipt-content">
                <div class="receipt-header">
                    <div class="receipt-title">Receipt</div>
                    <div class="receipt-subtitle">Shankara Prakashana Samithi</div>
                </div>

                <div class="receipt-details">
                    <div class="receipt-field">
                        <div class="receipt-field-label">Receipt No</div>
                        <div class="receipt-field-value" id="receiptNo">---</div>
                    </div>

                    <div class="receipt-field">
                        <div class="receipt-field-label">Date</div>
                        <div class="receipt-field-value" id="receiptDate">---</div>
                    </div>

                    <div class="receipt-field">
                        <div class="receipt-field-label">Donor Name</div>
                        <div class="receipt-field-value" id="displayDonorName">---</div>
                    </div>

                    <div class="receipt-field">
                        <div class="receipt-field-label">Phone</div>
                        <div class="receipt-field-value" id="displayPhone">---</div>
                    </div>

                    <div class="receipt-field">
                        <div class="receipt-field-label">Address</div>
                        <div class="receipt-field-value" id="displayAddress">---</div>
                    </div>
                </div>

                <div class="receipt-items-header">
                    <div>Item</div>
                    <div>Qty</div>
                    <div>Amount</div>
                </div>

                <div class="receipt-items" id="receiptItems"></div>

                <div class="receipt-total">
                    <div class="total-label">Total Amount</div>
                    <div class="total-amount" id="totalAmount">₹0</div>
                </div>

                <div class="receipt-actions">
                    <button class="btn-share" onclick="shareReceipt()">Share</button>
                    <button class="btn-print" onclick="printReceipt()">Print</button>
                </div>
            </div>

            <div class="empty-receipt">
                <p>Fill the form and click "Generate Receipt" to see your receipt here.</p>
            </div>
        </div>
    </div>

    <!-- Share Modal -->
    <div id="shareModal" class="modal">
        <div class="modal-content">
            <h2>Share Receipt</h2>
            <p>Choose how you'd like to share this receipt:</p>
            <div class="modal-buttons">
                <button class="btn-cancel" onclick="closeModal()">Cancel</button>
                <button class="btn-confirm" onclick="downloadReceipt()">Download as Image</button>
            </div>
        </div>
    </div>

    <script>
        const items = [
            { name: 'Saraswati Pramukha Poshakaru', price: 100000 },
            { name: 'Bhamini Maha Poshakaru', price: 50000 },
            { name: 'Girvani Jgnana Poshakaru', price: 25000 },
            { name: 'Veenapaani Poshakaru', price: 10000 },
            { name: 'Complete Set', price: 6000 },
            { name: 'Full Set A (Ramayana)', price: 4000 },
            { name: 'Full Set B (All Other 5)', price: 4000 },
            { name: 'Ramayana', price: 4000 },
            { name: 'Brahmantaranga', price: 1000 },
            { name: 'Geetantaranga', price: 1000 },
            { name: 'Sankshipta Ramayana', price: 400 },
            { name: 'Kathopanishath', price: 400 },
            { name: 'Saundarya Lahari', price: 400 }
        ];

        let selectedDate = new Date();
        let receiptNumber = Math.floor(Math.random() * 99999) + 1;

        // Initialize date pills
        function initializeDatePills() {
            const container = document.getElementById('datePills');
            container.innerHTML = '';
            
            for (let i = -3; i <= 3; i++) {
                const date = new Date();
                date.setDate(date.getDate() + i);
                
                const button = document.createElement('button');
                button.className = 'date-pill' + (i === 0 ? ' active' : '');
                button.innerHTML = `
                    <div class="date-pill-day">${date.toLocaleDateString('en-US', { weekday: 'short' })}</div>
                    <div class="date-pill-date">${date.getDate()}</div>
                `;
                
                button.addEventListener('click', () => selectDate(date));
                container.appendChild(button);
            }
        }

        function selectDate(date) {
            selectedDate = date;
            
            // Remove active class from all pills
            document.querySelectorAll('.date-pill').forEach(pill => {
                pill.classList.remove('active');
            });
            
            // Find and activate the correct pill
            const pills = document.querySelectorAll('.date-pill');
            pills.forEach((pill, index) => {
                const pillDate = new Date();
                pillDate.setDate(pillDate.getDate() + (index - 3));
                if (pillDate.toDateString() === date.toDateString()) {
                    pill.classList.add('active');
                }
            });
        }

        // Handle quantity changes
        document.addEventListener('change', function(e) {
            if (e.target.classList.contains('quantity-select')) {
                const checkbox = e.target.closest('.checkbox-group').querySelector('input[type="checkbox"]');
                const priceSpan = e.target.closest('.checkbox-group').querySelector('.item-price');
                const quantity = parseInt(e.target.value);
                const basePrice = parseInt(e.target.dataset.basePrice);
                const newPrice = basePrice * quantity;
                
                // Auto-select checkbox when quantity is changed
                checkbox.checked = true;
                checkbox.dataset.price = newPrice;
                priceSpan.textContent = '₹' + newPrice.toLocaleString();
            }
        });

        // Handle donation amount changes
        document.addEventListener('input', function(e) {
            if (e.target.classList.contains('donation-input')) {
                const amount = parseInt(e.target.value) || 0;
                const checkbox = document.getElementById('donation-checkbox');
                const displaySpan = document.getElementById('donation-display');
                
                checkbox.dataset.price = amount;
                checkbox.dataset.basePrice = amount;
                displaySpan.textContent = amount.toLocaleString();
                
                // Auto-select checkbox when amount is entered
                if (amount > 0) {
                    checkbox.checked = true;
                }
            }
        });

        function generateReceipt() {
            const donorName = document.getElementById('donorName').value;
            const phone = document.getElementById('phone').value;
            const address = document.getElementById('address').value;

            if (!donorName || !phone || !address) {
                alert('Please fill all donor details');
                return;
            }

            const selectedItems = [];
            let total = 0;

            document.querySelectorAll('.checkbox-group').forEach(group => {
                const checkbox = group.querySelector('.item-checkbox:checked');
                if (checkbox) {
                    const itemName = checkbox.value;
                    let basePrice = parseInt(checkbox.getAttribute('data-basePrice')) || 0;
                    let quantity = 1;
                    let itemPrice = basePrice;
                    
                    // Special handling for donation - don't use quantity
                    if (itemName === 'Donation') {
                        itemPrice = basePrice;
                    } else {
                        // For regular items, use quantity multiplier
                        const quantitySelect = group.querySelector('.quantity-select');
                        quantity = parseInt(quantitySelect.value);
                        itemPrice = basePrice * quantity;
                    }
                    
                    selectedItems.push({ 
                        name: itemName, 
                        basePrice: basePrice, 
                        quantity: quantity, 
                        totalPrice: itemPrice 
                    });
                    total += itemPrice;
                }
            });

            if (selectedItems.length === 0) {
                alert('Please select at least one item');
                return;
            }

            // Update receipt
            document.getElementById('receiptNo').textContent = 'SPS-' + receiptNumber;
            document.getElementById('receiptDate').textContent = selectedDate.toLocaleDateString('en-GB');
            document.getElementById('displayDonorName').textContent = donorName;
            document.getElementById('displayPhone').textContent = phone;
            document.getElementById('displayAddress').textContent = address;

            const receiptItemsHtml = selectedItems.map(item => 
                `<div class="receipt-item">
                    <div>
                        <div class="receipt-item-name">${item.name}</div>
                        <div class="receipt-item-meta">₹${item.basePrice.toLocaleString()} each</div>
                    </div>
                    <div class="receipt-item-qty">${item.quantity}</div>
                    <div class="receipt-item-price">₹${item.totalPrice.toLocaleString()}</div>
                </div>`
            ).join('');

            document.getElementById('receiptItems').innerHTML = receiptItemsHtml;
            document.getElementById('totalAmount').textContent = '₹' + total.toLocaleString();

            // Show receipt
            document.getElementById('receipt').classList.add('visible');
            document.querySelector('.empty-receipt').style.display = 'none';
        }

        function resetForm() {
            document.getElementById('donorName').value = '';
            document.getElementById('phone').value = '';
            document.getElementById('address').value = '';
            
            document.querySelectorAll('.item-checkbox').forEach(checkbox => {
                checkbox.checked = false;
            });

            document.querySelectorAll('.quantity-select').forEach(select => {
                select.value = '1';
            });

            document.getElementById('donation-amount').value = '';
            document.getElementById('donation-display').textContent = '0';

            document.querySelectorAll('.item-price').forEach((span, index) => {
                const basePrice = items[index].price;
                span.textContent = '₹' + basePrice.toLocaleString();
            });

            document.getElementById('receipt').classList.remove('visible');
            document.querySelector('.empty-receipt').style.display = 'block';
        }

        function printReceipt() {
            window.print();
        }

        function shareReceipt() {
            // Check if device is mobile
            const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
            
            // Check if Web Share API is available
            if (isMobile && navigator.share) {
                // Mobile device with Web Share API support
                const receiptDiv = document.getElementById('receipt');
                html2canvas(receiptDiv, {
                    backgroundColor: '#FEF9F2',
                    scale: 2
                }).then(canvas => {
                    canvas.toBlob(blob => {
                        const file = new File([blob], 'receipt-' + new Date().getTime() + '.png', { type: 'image/png' });
                        
                        navigator.share({
                            title: 'Shankara Prakashana Samithi Receipt',
                            text: 'Here is my donation receipt',
                            files: [file]
                        }).catch(err => {
                            console.log('Sharing cancelled or failed');
                            // Show modal as fallback
                            document.getElementById('shareModal').classList.add('active');
                        });
                    });
                });
            } else {
                // Desktop or devices without Web Share API - show modal
                document.getElementById('shareModal').classList.add('active');
            }
        }

        function closeModal() {
            document.getElementById('shareModal').classList.remove('active');
        }

        function downloadReceipt() {
            const receiptDiv = document.getElementById('receipt');
            html2canvas(receiptDiv, {
                backgroundColor: '#FEF9F2',
                scale: 2
            }).then(canvas => {
                canvas.toBlob(blob => {
                    downloadReceiptFallback(blob);
                    closeModal();
                });
            });
        }

        function downloadReceiptFallback(blob) {
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'receipt-' + new Date().getTime() + '.png';
            link.click();
            URL.revokeObjectURL(link.href);
        }

        window.addEventListener('click', function(e) {
            const modal = document.getElementById('shareModal');
            if (e.target === modal) {
                closeModal();
            }
        });

        // Initialize
        initializeDatePills();
    </script>
</body>
</html>
